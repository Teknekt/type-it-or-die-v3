<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Type It or Die</title>
  <link rel="stylesheet" href="styles.css" />
  <script defer src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #0e0e0e;
      color: white;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
    }
    .game-container {
      text-align: center;
      max-width: 500px;
      width: 90%;
    }
    h1 {
      font-size: 2.5rem;
      margin-bottom: 0.5rem;
    }
    .word-display {
      font-size: 2rem;
      margin: 20px 0;
    }
    input, button {
      padding: 10px;
      font-size: 1.2rem;
      width: 100%;
      margin-top: 10px;
    }
    .info {
      display: flex;
      justify-content: space-between;
      margin-top: 15px;
      font-size: 1.1rem;
    }
    .leaderboard {
      margin-top: 30px;
      background: #1e1e1e;
      padding: 20px;
      border-radius: 10px;
      width: 100%;
    }
    .share-buttons {
      margin-top: 20px;
    }
    #nameInputContainer {
      margin-top: 20px;
    }
    #startBtn {
      background: #2e8b57;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <div class="game-container">
    <h1>Type It or Die</h1>
    <p>Type the words fast! Miss one and it's over. Bonus time for hard words.</p>
    <div id="nameInputContainer">
      <input type="text" id="playerName" placeholder="Enter your name" />
      <button id="startBtn">Start Game</button>
    </div>
    <div class="word-display" id="word"></div>
    <input type="text" id="text" autocomplete="off" placeholder="Type here..." style="display:none;" />
    <div class="info">
      <div>Time: <span id="time">10</span>s</div>
      <div>Score: <span id="score">0</span></div>
    </div>
    <div class="leaderboard" id="leaderboard">
      <h3>üèÜ Global Highscores</h3>
      <ul id="scores"></ul>
    </div>
    <div class="share-buttons">
      <button onclick="shareTwitter()">Share on Twitter</button>
      <button onclick="shareFacebook()">Share on Facebook</button>
    </div>
  </div>

  <!-- Google AdSense -->
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <ins class="adsbygoogle"
       style="display:block; text-align:center; margin-top: 30px"
       data-ad-client="ca-pub-7723689755297651"
       data-ad-slot="6475259413"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>

  <!-- Sounds -->
  <audio id="successSound" src="https://assets.mixkit.co/sfx/preview/mixkit-positive-interface-beep-221.mp3"></audio>
  <audio id="failSound" src="https://assets.mixkit.co/sfx/preview/mixkit-wrong-answer-fail-notification-946.mp3"></audio>

  <script>
    const easyWords = ["apple", "sun", "cat", "ball", "car", "dog", "home", "fish", "star", "cake", "milk", "book", "pen", "tree", "shoe"];
    const hardWords = ["algorithm", "hypothesis", "cryptography", "juxtaposition", "miscellaneous"];
    const extraWords = ["planet", "rocket", "banana", "python", "keyboard", "monitor", "science", "future", "travel", "happiness", "strategy", "gadget", "network", "ocean", "system", "virtual", "wizard", "energy", "signal", "memory"];
    let words = [...easyWords, ...hardWords, ...extraWords];

    const wordEl = document.getElementById("word");
    const text = document.getElementById("text");
    const scoreEl = document.getElementById("score");
    const timeEl = document.getElementById("time");
    const scoresList = document.getElementById("scores");
    const successSound = document.getElementById("successSound");
    const failSound = document.getElementById("failSound");
    const startBtn = document.getElementById("startBtn");
    const playerNameInput = document.getElementById("playerName");
    const nameInputContainer = document.getElementById("nameInputContainer");

    let score = 0;
    let time = 10;
    let currentWord = "";
    let timerInterval;
    let playerName = "Anonymous";

    const supabaseUrl = "https://wtzfzuragddwggmdemqf.supabase.co";
    const supabaseKey = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Ind0emZ6dXJhZ2Rkd2dnbWRlbXFmIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQ1MDAxOTEsImV4cCI6MjA3MDA3NjE5MX0.eNFGNive5js3JYBnKpVMPlI5Xi0CKdxfUWNklRzA9F0";
    const supabase = supabase.createClient(supabaseUrl, supabaseKey);

    function getRandomWord() {
      const idx = Math.floor(Math.random() * words.length);
      return words[idx];
    }

    function displayWord() {
      currentWord = getRandomWord();
      wordEl.innerText = currentWord;
    }

    function updateScore() {
      score++;
      scoreEl.innerText = score;
    }

    function updateTime(bonus = 0) {
      time += bonus;
      timeEl.innerText = time;
    }

    function gameOver() {
      failSound.play();
      clearInterval(timerInterval);
      text.disabled = true;
      saveScore(score);
    }

    function startGame() {
      playerName = playerNameInput.value.trim() || "Anonymous";
      nameInputContainer.style.display = "none";
      text.style.display = "block";
      text.disabled = false;
      text.focus();
      displayWord();
      score = 0;
      time = 10;
      scoreEl.innerText = score;
      timeEl.innerText = time;
      clearInterval(timerInterval);
      timerInterval = setInterval(() => {
        time--;
        timeEl.innerText = time;
        if (time === 0) {
          gameOver();
        }
      }, 1000);
    }

    startBtn.addEventListener("click", startGame);

    text.addEventListener("input", e => {
      const typedText = e.target.value.trim();
      if (typedText.toLowerCase() === currentWord.toLowerCase()) {
        successSound.play();
        displayWord();
        e.target.value = "";
        updateScore();
        updateTime(hardWords.includes(currentWord) ? 3 : 1);
      }
    });

    async function saveScore(newScore) {
      const { error } = await supabase.from("highscores").insert([
        { name: playerName, score: newScore }
      ]);
      if (!error) loadScores();
    }

    async function loadScores() {
      const { data, error } = await supabase
        .from("highscores")
        .select("name, score")
        .order("score", { ascending: false })
        .limit(10);
      if (!error) {
        scoresList.innerHTML = data.map(entry => `<li>${entry.name}: ${entry.score}</li>`).join("");
      }
    }

    function shareTwitter() {
      const url = encodeURIComponent(window.location.href);
      const text = encodeURIComponent(`I scored ${score} in Type It or Die! Can you beat me?`);
      window.open(`https://twitter.com/intent/tweet?text=${text}&url=${url}`, "_blank");
    }

    function shareFacebook() {
      const url = encodeURIComponent(window.location.href);
      window.open(`https://www.facebook.com/sharer/sharer.php?u=${url}`, "_blank");
    }

    loadScores();
  </script>
</body>
</html>
