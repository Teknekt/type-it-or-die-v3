<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Type It or Die - Retro</title>
  <link rel="stylesheet" href="styles.css" />
  <link rel="icon" href="favicon.ico" />
  
  <!-- Google AdSense -->
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7723689755297651"
    crossorigin="anonymous"></script>
</head>
<body>
  <div class="container">
    <h1 class="title">TYPE IT OR DIE</h1>
    
    <div id="ad">
      <ins class="adsbygoogle"
        style="display:block"
        data-ad-client="ca-pub-7723689755297651"
        data-ad-slot="6475259413"
        data-ad-format="auto"
        data-full-width-responsive="true"></ins>
      <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
      </script>
    </div>

    <div class="game-box">
      <input type="text" id="usernameInput" placeholder="Enter your name" />
      <button id="startBtn">Start Game</button>
      
      <div id="gameArea" style="display:none;">
        <div id="wordDisplay">WORD</div>
        <input type="text" id="wordInput" autocomplete="off" />
        <div id="timer">Time: 10</div>
        <div id="score">Score: 0</div>
      </div>

      <div id="highscores">
        <h2>Global Highscores</h2>
        <ul id="scoreList"></ul>
      </div>
    </div>
  </div>

  <!-- Ljud -->
  <audio id="correctSound" src="sounds/correct.mp3" preload="auto"></audio>
  <audio id="wrongSound" src="sounds/wrong.mp3" preload="auto"></audio>

  <!-- Supabase JS -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>

  <script>
    const supabaseUrl = "https://wtzfzuragddwggmdemqf.supabase.co";
    const supabaseKey = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Ind0emZ6dXJhZ2Rkd2dnbWRlbXFmIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQ1MDAxOTEsImV4cCI6MjA3MDA3NjE5MX0.eNFGNive5js3JYBnKpVMPlI5Xi0CKdxfUWNklRzA9F0";
    const supabase = supabase.createClient(supabaseUrl, supabaseKey);

    let currentWord = "";
    let score = 0;
    let time = 10;
    let timerInterval;
    let username = "";

    const words = [
      "space", "laser", "cyber", "retro", "pixel", "galaxy", "neon", "type", "die", "warp", "robot",
      "rocket", "blast", "alien", "light", "code", "hack", "loop", "fast", "doom",
      "titanium", "quantum", "teleport", "universe", "asteroid", "supernova", "android"
    ];

    function getRandomWord() {
      return words[Math.floor(Math.random() * words.length)];
    }

    function startGame() {
      username = document.getElementById("usernameInput").value || "Anonymous";
      document.getElementById("usernameInput").style.display = "none";
      document.getElementById("startBtn").style.display = "none";
      document.getElementById("gameArea").style.display = "block";
      document.getElementById("wordInput").focus();

      score = 0;
      time = 10;
      document.getElementById("score").textContent = `Score: ${score}`;
      document.getElementById("timer").textContent = `Time: ${time}`;
      showNewWord();

      timerInterval = setInterval(() => {
        time--;
        document.getElementById("timer").textContent = `Time: ${time}`;
        if (time <= 0) {
          endGame();
        }
      }, 1000);
    }

    function showNewWord() {
      currentWord = getRandomWord();
      document.getElementById("wordDisplay").textContent = currentWord;
      document.getElementById("wordInput").value = "";
    }

    function endGame() {
      clearInterval(timerInterval);
      document.getElementById("gameArea").style.display = "none";
      document.getElementById("startBtn").style.display = "block";
      document.getElementById("usernameInput").style.display = "block";

      saveScore();
    }

    async function saveScore() {
      const { error } = await supabase
        .from("highscores")
        .insert([{ username, score }]);
      if (error) {
        console.error("Error saving score:", error);
      } else {
        loadScores();
      }
    }

    async function loadScores() {
      const { data, error } = await supabase
        .from("highscores")
        .select("*")
        .order("score", { ascending: false })
        .limit(10);
      if (error) {
        console.error("Error loading scores:", error);
      } else {
        const list = document.getElementById("scoreList");
        list.innerHTML = "";
        data.forEach((entry) => {
          const li = document.createElement("li");
          li.textContent = `${entry.username}: ${entry.score}`;
          list.appendChild(li);
        });
      }
    }

    document.getElementById("startBtn").addEventListener("click", startGame);
    document.getElementById("wordInput").addEventListener("keydown", function (e) {
      if (e.key === "Enter") {
        if (this.value.trim().toLowerCase() === currentWord.toLowerCase()) {
          document.getElementById("correctSound").play();
          score++;
          time += 2;
          document.getElementById("score").textContent = `Score: ${score}`;
          showNewWord();
        } else {
          document.getElementById("wrongSound").play();
          time -= 2;
        }
      }
    });

    loadScores();
  </script>
</body>
</html>
